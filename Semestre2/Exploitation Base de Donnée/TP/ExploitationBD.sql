select * from basetd.distribution;
select * from basetd.commune;
select * from basetd.operateur;

select * 
    from basetd.operateur op, basetd.distribution di, basetd.commune co, basetd.departement de
    where co.nom_commune = 'Nantes'
        and co.code_insee = di.code_insee
        and di.numfo = op.numfo
        and de.nomdep = co.nomdep;
        
select * 
    from basetd.operateur op, basetd.distribution di, basetd.commune co, basetd.departement de
    where co.nom_commune = 'Nantes'
        and op.generation = '5G'
        and co.code_insee = di.code_insee
        and di.numfo = op.numfo
        and de.nomdep = co.nomdep;
        
select di.adresse, op.nomfo 
    from basetd.operateur op, basetd.distribution di, basetd.commune co, basetd.departement de
    where co.nom_commune = 'Nantes'
        and op.generation = '5G'
        and op.technologie = '5G NR 3500'
        and co.code_insee = di.code_insee
        and di.numfo = op.numfo
        and de.nomdep = co.nomdep;
        
select co.nom_commune, op.nomfo, op.generation
    from basetd.operateur op, basetd.distribution di, basetd.commune co
    where op.generation = '5G'
        and co.code_insee = di.code_insee
        and di.numfo = op.numfo;

select co.nom_commune,op.nomfo, count(*)
    from basetd.operateur op, basetd.distribution di, basetd.commune co
    where op.generation = '5G'
        and co.code_insee = di.code_insee
        and di.numfo = op.numfo
        group by co.nom_commune,op.nomfo
        order by 1,3 desc;

select co.nom_commune, count(*)
    from basetd.distribution di, basetd.commune co, basetd.operateur op 
    where op.numfo = di.numfo and
        di.code_insee = co.code_insee and
        op.generation = '5G'
        group by co.nom_commune
        order by  2 desc
        fetch next 10 rows only;

select co.nom_commune, count(*)
    from basetd.distribution di, basetd.commune co, basetd.operateur op 
    where op.numfo = di.numfo 
        and di.code_insee = co.code_insee 
        and op.generation = '5G' 
        having count(*) > 50
        group by co.nom_commune
        order by  2 desc
        fetch next 10 rows only;
        
select de.nomdep, op.nomfo, op.generation, count(*)
    from BASETD.departement de, BASETD.operateur op, basetd.commune co, basetd.distribution di
    where co.nomdep = de.nomdep 
    and op.generation = '4G'
    and op.numfo = di.numfo 
    and di.code_insee = co.code_insee
    group by de.nomdep,op.nomfo,op.generation
    order by 1,2 ,4 desc;

