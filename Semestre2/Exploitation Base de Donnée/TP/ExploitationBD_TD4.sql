---Question 1---

select distinct di.numfo
    from BASETD.commune co, BASETD.operateur op,BASETD.distribution di
        where op.numfo = di.numfo
        and di.code_insee = co.code_insee
        and op.generation in ('5G','4G')
        and co.nomdep = 'Loire-Atlantique';

create TABLE DistributionLA as select * from basetd.distribution di where di.code_insee in (select co.code_insee from CommuneLA co);

create TABLE CommuneLA as select * from basetd.commune co where co.code_insee in (select distinct co.code_insee
                                                                                                from BASETD.commune co, BASETD.operateur op,BASETD.distribution di
                                                                                                    where op.numfo = di.numfo
                                                                                                    and di.code_insee = co.code_insee
                                                                                                    and op.generation in ('5G','4G')
                                                                                                    and co.nomdep = 'Loire-Atlantique') ;
create TABLE OperateurLA as select * from basetd.operateur;

drop table DistributionLA;
drop table CommuneLA;

select * from basetd.operateur;